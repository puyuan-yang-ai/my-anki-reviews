# AIé¢è¯•è¯„ä¼°æŠ¥å‘Šç³»ç»Ÿè§„èŒƒï¼ˆåŸºäºGoldenä»£ç ï¼‰

## ğŸ¯ æ ¸å¿ƒæ€è·¯

**å¤šæ­¥éª¤æ·±åº¦åˆ†æ**ï¼šè‡ªé€‚åº”æŠ½å–è€ƒæ ¸ç»´åº¦ â†’ é€é¡¹æ‰“åˆ†è¯„ä¼° â†’ ç»¼åˆæ€»ç»“æŠ¥å‘Š â†’ å¤šæ¨¡æ€é£æ ¼åˆ†æ â†’ å€™é€‰äººåé¦ˆ

## ğŸ“‹ æ ¸å¿ƒåŠŸèƒ½

### è¾“å…¥
- é¢è¯•å¯¹è¯è®°å½•ï¼ˆtranscriptï¼‰
- å²—ä½æè¿°ï¼ˆJDï¼‰
- è§†é¢‘/å›¾ç‰‡URLï¼ˆurl_listï¼‰
- é¢è¯•è¯­è¨€ï¼ˆinterview_languageï¼‰

### è¾“å‡º
- HRè§†è§’ï¼šç»¼åˆè¯„åˆ†ã€äº®ç‚¹ã€é£é™©ã€è¯„çº§ï¼ˆT0~T4ï¼‰
- å€™é€‰äººè§†è§’ï¼šä¼˜åŠ¿ã€ä¸è¶³ã€çŸ­æœŸ/é•¿æœŸæ”¹è¿›å»ºè®®
- å¤šæ¨¡æ€ï¼šé£æ ¼æ ‡ç­¾ã€å½¢è±¡è¯„åˆ†ã€è¡Œä¸ºæ£€æµ‹

### å¤„ç†æ–¹å¼
- **3+Næ¬¡AIè°ƒç”¨**ï¼ˆN=è€ƒæ ¸ç»´åº¦æ•°é‡ï¼Œé€šå¸¸5-10ä¸ªï¼‰
- è‡ªé€‚åº”æŠ½å–ç»´åº¦ï¼Œé€é¡¹ç‹¬ç«‹è¯„åˆ†
- å¤šæ¨¡æ€åˆ†æï¼ˆæ”¯æŒè§†é¢‘/å›¾ç‰‡ï¼‰

## ğŸ’» æ ¸å¿ƒå®ç°

### æ–‡ä»¶ç»“æ„
```
service/
â”œâ”€â”€ AIInterviewAssessor.py    # æ ¸å¿ƒæœåŠ¡ï¼ˆ327è¡Œï¼‰
â””â”€â”€ multimodal_report.py       # å¤šæ¨¡æ€åˆ†æï¼ˆ100è¡Œï¼‰
routers/
â””â”€â”€ interview_report_router.py # APIè·¯ç”±ï¼ˆ97è¡Œï¼‰
```

### æ ¸å¿ƒæµç¨‹ï¼ˆ5æ­¥ï¼‰
```python
def generate_report(transcript, jd, interview_id, url_list, is_mp4, language):
    # æ­¥éª¤1: æŠ½å–è€ƒæ ¸ç»´åº¦ (1æ¬¡AIè°ƒç”¨)
    competencies = _extract_competencies(jd, transcript)
    # è¾“å‡º: {hard_skills: [...], soft_skills: [...], cultural_fit: [...]}
    
    # æ­¥éª¤2: é€é¡¹èƒ½åŠ›è¯„ä¼° (Næ¬¡AIè°ƒç”¨)
    for competency in all_competency_keys:
        result = _analyze_single_competency(competency, transcript)
        # è¾“å‡º: {score: 85, rationale: "...", evidence_quotes: [...]}
    
    # æ­¥éª¤3: ç”ŸæˆHRæ€»ç»“ (1æ¬¡AIè°ƒç”¨)
    summary = _generate_final_summary(detailed_analysis)
    # è¾“å‡º: {highlights: "...", risks: "...", conclusion: "T2-èƒœä»»..."}
    
    # æ­¥éª¤4: å¤šæ¨¡æ€åˆ†æ (1æ¬¡AIè°ƒç”¨, qwen-vl-max-latest)
    style = style_report(url_list, interview_id, is_mp4, language)
    # è¾“å‡º: {style: "èŒä¸šå¹²ç»ƒ", description: "...", appearance: "82åˆ†..."}
    
    # æ­¥éª¤5: ç”Ÿæˆå€™é€‰äººæŠ¥å‘Š (1æ¬¡AIè°ƒç”¨)
    user_report = _user_report(jd, transcript, hr_report)
    # è¾“å‡º: {highlights, insufficient, short_term_actions, long_term_actions, ...}
    
    # èšåˆæœ€ç»ˆæŠ¥å‘Š â†’ å­˜å…¥æ•°æ®åº“
    return final_report
```

## ğŸŒ APIæ¥å£

**POST** `/interviewReport`

### è¯·æ±‚
```json
{
  "interview_id": "123456",
  "transcript": [
    {"role": "interviewer", "content": "ä»‹ç»ä½ çš„Pythonç»éªŒ", "timestamp": 1},
    {"role": "candidate", "content": "æˆ‘æœ‰3å¹´Pythonå¼€å‘ç»éªŒ...", "timestamp": 2}
  ],
  "jd": "å²—ä½èŒè´£ï¼š\n1. åç«¯å¼€å‘\nä»»èŒè¦æ±‚ï¼š\n1. 3å¹´Pythonç»éªŒ",
  "interview_language": "zhongwen",
  "p_url": ["http://example.com/img1.png"],  // å›¾ç‰‡URL
  "v_url": ["http://example.com/video.mp4"]   // è§†é¢‘URL
}
```

### å“åº”ï¼ˆç«‹å³è¿”å›ï¼Œåå°å¼‚æ­¥ç”Ÿæˆï¼‰
```json
{
  "code": 0,
  "message": "success",
  "data": ""
}
```

### æœ€ç»ˆæŠ¥å‘Šç»“æ„ï¼ˆå­˜å…¥æ•°æ®åº“ï¼‰
```json
{
  "overall_assessment": {
    "match_score": 78.5,
    "conclusion": "T2-èƒœä»»ï¼Œå®šä¹‰ï¼šç¬¦åˆé¢„æœŸã€‚å»ºè®®å½•ç”¨ã€‚",
    "highlights": "æŠ€æœ¯åŸºç¡€æ‰å®ï¼Œæ²Ÿé€šæ¸…æ™°",
    "potential_risks": "ç¼ºä¹æ¶æ„ç»éªŒ"
  },
  "detailed_analysis": [
    {
      "competency": "Pythonå¼€å‘èƒ½åŠ›",
      "score": 85,
      "rationale": "æ‰å®çš„å¼€å‘åŸºç¡€ï¼Œç†Ÿæ‚‰Djangoæ¡†æ¶",
      "evidence_quotes": ["æˆ‘ä¸»å¯¼äº†è®¢å•ç³»ç»Ÿå¼€å‘", "æ—¥å‡100ä¸‡è¯·æ±‚é‡"]
    }
  ],
  "competency_model_used": {
    "hard_skills": ["Pythonå¼€å‘", "æ•°æ®åº“è®¾è®¡"],
    "soft_skills": ["æ²Ÿé€šèƒ½åŠ›"],
    "cultural_fit": ["å­¦ä¹ æ€åº¦"]
  },
  "style_report": {
    "style": "èŒä¸šå¹²ç»ƒ",
    "description": "çœ¼ç¥è‡ªä¿¡ï¼Œç€è£…å¾—ä½“",
    "behavior": "æœªå‘ç°å¼‚å¸¸",
    "appearance": "82åˆ†ã€‚äº”å®˜ç«¯æ­£ï¼Œæ­£è£…æ•´æ´"
  },
  "user_report": {
    "highlights": "ä½ çš„æŠ€æœ¯è¡¨è¾¾æ¸…æ™°...",
    "insufficient": "æ¶æ„è®¾è®¡å¯ä»¥æ›´æœ‰æ¡ç†...",
    "short_term_actions": ["æ¯å¤©ç»ƒä¹ 1ä¸ªç®—æ³•é¢˜", "å‡†å¤‡3ä¸ªSTARè¯æœ¯"],
    "long_term_actions": ["å­¦ä¹ åˆ†å¸ƒå¼ç³»ç»Ÿ", "å‚ä¸å¼€æºé¡¹ç›®"],
    "Quantitative": "æ¯å‘¨2æ¬¡æ¨¡æ‹Ÿé¢è¯•ï¼Œè®°å½•æ”¹è¿›ç‚¹",
    "career_advice": "å‘é«˜çº§å·¥ç¨‹å¸ˆå‘å±•ï¼Œè¡¥å……æ¶æ„èƒ½åŠ›",
    "other": "ä¿æŒå­¦ä¹ èŠ‚å¥ï¼Œ3å¹´å†…å¯æˆé•¿ä¸ºæ¶æ„å¸ˆ"
  }
}
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### LLMé…ç½®
```python
# æ–‡æœ¬åˆ†ææ¨¡å‹
model = "qwen-plus"
temperature = 0.3
seed = 6
response_format = {"type": "json_object"}

# å¤šæ¨¡æ€æ¨¡å‹
multimodal_model = "qwen-vl-max-latest"
```

### é‡è¦æœºåˆ¶
- **é‡è¯•æœºåˆ¶**ï¼šå…³é”®AIè°ƒç”¨å¤±è´¥è‡ªåŠ¨é‡è¯•1æ¬¡
- **å¤šæ¨¡æ€ä¿åº•**ï¼šè§†é¢‘åˆ†æå¤±è´¥é™çº§ä¸ºæ–‡æœ¬åˆ†æ
- **å¼‚æ­¥å¤„ç†**ï¼šFastAPI BackgroundTasksåå°ç”Ÿæˆ
- **é˜²é‡å¤**ï¼š10åˆ†é’Ÿå†…åŒinterview_idä¸é‡å¤ç”Ÿæˆ

### æ”¯æŒçš„è¯­è¨€
zhongwenã€yingwenã€riyuã€hanyuã€xibanyayuã€yinniyuã€fayuã€deyuã€taiyu

## ğŸ“Š å…³é”®æŒ‡æ ‡

- **AIè°ƒç”¨æ¬¡æ•°**ï¼šé€šå¸¸8-15æ¬¡ï¼ˆ3å›ºå®š + 5-10ç»´åº¦è¯„ä¼°ï¼‰
- **ç”Ÿæˆè€—æ—¶**ï¼š3-5åˆ†é’Ÿ
- **æˆåŠŸç‡**ï¼š>95%ï¼ˆå¤šå±‚é‡è¯•ä¿éšœï¼‰
- **è¯„çº§ä½“ç³»**ï¼šT0å“è¶Š / T1å¨´ç†Ÿ / T2èƒœä»» / T3å¾…åŸ¹å…» / T4å·®è·è¾ƒå¤§

---

**æ ¸å¿ƒåŸåˆ™**ï¼šè‡ªé€‚åº”ç»´åº¦æŠ½å– + é€é¡¹ç‹¬ç«‹è¯„ä¼° + åŒè§†è§’æŠ¥å‘Š + å¤šæ¨¡æ€å¢å¼º

# AIé¢è¯•è¯„ä¼°æŠ¥å‘Šç³»ç»Ÿå¿«é€Ÿå‚è€ƒï¼ˆåŸºäºGoldenä»£ç ï¼‰

## ğŸ¯ æ ¸å¿ƒæ–‡ä»¶ï¼ˆ3ä¸ªï¼‰

```
service/AIInterviewAssessor.py       # 327è¡Œ - ä¸»æœåŠ¡
service/multimodal_report.py         # 100è¡Œ - å¤šæ¨¡æ€åˆ†æ  
routers/interview_report_router.py   # 97è¡Œ - APIè·¯ç”±
```

## ğŸ“ 5ä¸ªæ ¸å¿ƒæ–¹æ³•

### 1. `_extract_competencies(jd, transcript)` - æŠ½å–è€ƒæ ¸ç»´åº¦
```python
# ä»£ç ä½ç½®ï¼šAIInterviewAssessor.py:61-86
# åŠŸèƒ½ï¼šä»JDå’Œå¯¹è¯ä¸­æå–è€ƒæ ¸ç»´åº¦ï¼ˆè‡³å¤š10ä¸ªï¼‰
# è¾“å…¥ï¼šå²—ä½æè¿° + é¢è¯•æ–‡æœ¬
# è¾“å‡ºï¼š{hard_skills: [...], soft_skills: [...], cultural_fit: [...]}
# AIè°ƒç”¨ï¼š1æ¬¡
```

### 2. `_analyze_single_competency(competency, transcript)` - å•é¡¹è¯„ä¼°
```python
# ä»£ç ä½ç½®ï¼šAIInterviewAssessor.py:88-114
# åŠŸèƒ½ï¼šå¯¹å•ä¸ªç»´åº¦æ‰“åˆ†ã€ç»™å‡ºç†ç”±å’Œè¯æ®
# è¾“å…¥ï¼šç»´åº¦åç§° + é¢è¯•æ–‡æœ¬
# è¾“å‡ºï¼š{score: 85, rationale: "...", evidence_quotes: [...]}
# AIè°ƒç”¨ï¼šNæ¬¡ï¼ˆå¾ªç¯è°ƒç”¨ï¼‰
```

### 3. `_generate_final_summary(detailed_analysis)` - ç”ŸæˆHRæ€»ç»“
```python
# ä»£ç ä½ç½®ï¼šAIInterviewAssessor.py:116-144
# åŠŸèƒ½ï¼šåŸºäºæ‰€æœ‰ç»´åº¦ç”Ÿæˆæ€»ç»“å’Œè¯„çº§
# è¾“å…¥ï¼šæ‰€æœ‰ç»´åº¦çš„è¯¦ç»†åˆ†æ
# è¾“å‡ºï¼š{highlights: "...", risks: "...", conclusion: "T2-èƒœä»»..."}
# AIè°ƒç”¨ï¼š1æ¬¡
# è¯„çº§ï¼šT0å“è¶Š/T1å¨´ç†Ÿ/T2èƒœä»»/T3å¾…åŸ¹å…»/T4å·®è·è¾ƒå¤§
```

### 4. `style_report(url_list, ...)` - å¤šæ¨¡æ€é£æ ¼åˆ†æ
```python
# ä»£ç ä½ç½®ï¼šmultimodal_report.py:7-72
# åŠŸèƒ½ï¼šåŸºäºè§†é¢‘/å›¾ç‰‡åˆ†æé¢è¯•é£æ ¼
# è¾“å…¥ï¼šè§†é¢‘æˆ–å›¾ç‰‡URLåˆ—è¡¨
# è¾“å‡ºï¼š{style: "èŒä¸šå¹²ç»ƒ", description: "...", appearance: "82åˆ†..."}
# AIè°ƒç”¨ï¼š1æ¬¡ï¼ˆä½¿ç”¨qwen-vl-max-latestå¤šæ¨¡æ€æ¨¡å‹ï¼‰
# é£æ ¼æ ‡ç­¾ï¼šèŒä¸šå¹²ç»ƒ/å„’é›…çŸ¥æ€§/æ–‡å¼±æ¸©å’Œ/å½¢è±¡æ°”è´¨ä½³/çœŸå®ç›´ç‡/å†·é™ç†æ€§/çƒ­æƒ…å¤–å‘
```

### 5. `_user_report(jd, transcript, hr_report)` - ç”Ÿæˆå€™é€‰äººåé¦ˆ
```python
# ä»£ç ä½ç½®ï¼šAIInterviewAssessor.py:146-205
# åŠŸèƒ½ï¼šç”Ÿæˆå€™é€‰äººè§†è§’çš„æ”¹è¿›å»ºè®®
# è¾“å…¥ï¼šJD + é¢è¯•æ–‡æœ¬ + HRæŠ¥å‘Š
# è¾“å‡ºï¼š{highlights, insufficient, short_term_actions, long_term_actions, ...}
# AIè°ƒç”¨ï¼š1æ¬¡
# ç‰¹ç‚¹ï¼šä½¿ç”¨ç¬¬äºŒäººç§°ã€ç§¯æè¯­è¨€ã€å¯é‡åŒ–å»ºè®®
```

## ğŸ”§ å…³é”®æœºåˆ¶

### é‡è¯•æœºåˆ¶ï¼ˆä»£ç ä½ç½®ï¼šAIInterviewAssessor.py:229-257ï¼‰
```python
# 1. ç»´åº¦æŠ½å–å¤±è´¥ â†’ é‡è¯•1æ¬¡
if not all_competency_keys:
    competencies = self._extract_competencies(jd, transcript)

# 2. å•é¡¹è¯„ä¼°å¤±è´¥ â†’ é‡è¯•1æ¬¡  
if not analysis_result:
    analysis_result = self._analyze_single_competency(competency, transcript)

# 3. æ€»ç»“ç”Ÿæˆå¤±è´¥ â†’ é‡è¯•1æ¬¡ â†’ å†å¤±è´¥æŠ›å¼‚å¸¸
if not final_summary:
    final_summary = self._generate_final_summary(detailed_analysis)
```

### å¤šæ¨¡æ€ä¿åº•ï¼ˆä»£ç ä½ç½®ï¼šAIInterviewAssessor.py:265-268ï¼‰
```python
# è§†é¢‘åˆ†æå¤±è´¥ â†’ ä½¿ç”¨ç©ºURLé‡è¯•ï¼ˆçº¯æ–‡æœ¬åˆ†æï¼‰
if not style:
    style = style_report(url_list=[], interview_id=interview_id, ...)
```

### å¼‚æ­¥å¤„ç†ï¼ˆä»£ç ä½ç½®ï¼šinterview_report_router.py:56-62ï¼‰
```python
# FastAPI BackgroundTasksåå°ç”Ÿæˆï¼Œä¸é˜»å¡å“åº”
background_task.add_task(
    ai_report.generate_report,
    transcript_json_str=transcript,
    jd=jd,
    interview_id=interview_id,
    url_list=url_list,
    is_mp4=is_mp4,
    interview_language=interview_language
)
```

## ğŸš€ å¿«é€Ÿæµ‹è¯•

```bash
# 1. å¯åŠ¨æœåŠ¡
uvicorn app:app --host 0.0.0.0 --port 9006

# 2. å‘é€æµ‹è¯•è¯·æ±‚
curl -X POST http://localhost:9006/interviewReport \
  -H "Content-Type: application/json" \
  -d '{
    "interview_id": "test_123",
    "transcript": [
      {"role": "interviewer", "content": "ä»‹ç»ä½ çš„Pythonç»éªŒ", "timestamp": 1},
      {"role": "candidate", "content": "æˆ‘æœ‰3å¹´Pythonå¼€å‘ç»éªŒ", "timestamp": 2}
    ],
    "jd": "è¦æ±‚3å¹´Pythonç»éªŒï¼Œç†Ÿæ‚‰Django",
    "interview_language": "zhongwen",
    "p_url": [],
    "v_url": []
  }'

# 3. ç«‹å³è¿”å›ï¼ˆæŠ¥å‘Šåœ¨åå°ç”Ÿæˆ3-5åˆ†é’Ÿï¼‰
# {"code": 0, "message": "success"}
```

## ğŸ“Š é…ç½®æ–‡ä»¶ï¼ˆconfig/config.yamlï¼‰

```yaml
setting:
  ai:
    api_key: "sk-xxx"
    api_model: "qwen-plus"
    api_uri: "https://dashscope.aliyuncs.com/compatible-mode/v1"
  db:
    host: "xxx"
    database: "workplace"
  url:
    interview_report_post_url: "https://xxx/callback"  # å¤±è´¥å›è°ƒåœ°å€
```

---

**æ ¸å¿ƒç‰¹ç‚¹**ï¼šè‡ªé€‚åº” + å¤šæ­¥éª¤ + åŒè§†è§’ + å¤šæ¨¡æ€ + é«˜å¯é 
